changes from paper:
* in get_trajectory, I have made the sampling of test/dev always random.